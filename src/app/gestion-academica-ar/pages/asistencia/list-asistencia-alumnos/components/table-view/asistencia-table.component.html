<!-- asistencia-table.component.html -->
<div class="table-view">
  <table class="data-table">
    <thead>
      <tr>
        <th class="sortable" (click)="onSort('codigo')">
          <div class="column-header">
            <i class="fas fa-id-card"></i>
            <span>Código</span>
            <i *ngIf="sortColumn === 'codigo'" class="fas" 
              [ngClass]="{'fa-sort-up': sortDirection === 'asc', 'fa-sort-down': sortDirection === 'desc'}"></i>
          </div>
        </th>
        <th class="sortable" (click)="onSort('dni')">
          <div class="column-header">
            <i class="fas fa-id-badge"></i>
            <span>DNI</span>
            <i *ngIf="sortColumn === 'dni'" class="fas" 
              [ngClass]="{'fa-sort-up': sortDirection === 'asc', 'fa-sort-down': sortDirection === 'desc'}"></i>
          </div>
        </th>
        <th class="sortable" (click)="onSort('nombre')">
          <div class="column-header">
            <i class="fas fa-user"></i>
            <span>Nombre</span>
            <i *ngIf="sortColumn === 'nombre'" class="fas" 
              [ngClass]="{'fa-sort-up': sortDirection === 'asc', 'fa-sort-down': sortDirection === 'desc'}"></i>
          </div>
        </th>
        <th class="sortable" (click)="onSort('apellido')">
          <div class="column-header">
            <i class="fas fa-user"></i>
            <span>Apellido</span>
            <i *ngIf="sortColumn === 'apellido'" class="fas" 
              [ngClass]="{'fa-sort-up': sortDirection === 'asc', 'fa-sort-down': sortDirection === 'desc'}"></i>
          </div>
        </th>
        <th class="sortable" (click)="onSort('nivel')">
          <div class="column-header">
            <i class="fas fa-school"></i>
            <span>Nivel</span>
            <i *ngIf="sortColumn === 'nivel'" class="fas" 
              [ngClass]="{'fa-sort-up': sortDirection === 'asc', 'fa-sort-down': sortDirection === 'desc'}"></i>
          </div>
        </th>
        <th class="sortable" (click)="onSort('grado')">
          <div class="column-header">
            <i class="fas fa-graduation-cap"></i>
            <span>Grado</span>
            <i *ngIf="sortColumn === 'grado'" class="fas" 
              [ngClass]="{'fa-sort-up': sortDirection === 'asc', 'fa-sort-down': sortDirection === 'desc'}"></i>
          </div>
        </th>
        <th class="sortable" (click)="onSort('seccion')">
          <div class="column-header">
            <i class="fas fa-users"></i>
            <span>Sección</span>
            <i *ngIf="sortColumn === 'seccion'" class="fas" 
              [ngClass]="{'fa-sort-up': sortDirection === 'asc', 'fa-sort-down': sortDirection === 'desc'}"></i>
          </div>
        </th>
        <th class="sortable" (click)="onSort('turno')">
          <div class="column-header">
            <i class="fas fa-clock"></i>
            <span>Turno</span>
            <i *ngIf="sortColumn === 'turno'" class="fas" 
              [ngClass]="{'fa-sort-up': sortDirection === 'asc', 'fa-sort-down': sortDirection === 'desc'}"></i>
          </div>
        </th>
        <th class="sortable" (click)="onSort('horaLlegada')">
          <div class="column-header">
            <i class="fas fa-sign-in-alt"></i>
            <span>Llegada</span>
            <i *ngIf="sortColumn === 'horaLlegada'" class="fas" 
              [ngClass]="{'fa-sort-up': sortDirection === 'asc', 'fa-sort-down': sortDirection === 'desc'}"></i>
          </div>
        </th>
        <th class="sortable" (click)="onSort('horaSalida')">
          <div class="column-header">
            <i class="fas fa-sign-out-alt"></i>
            <span>Salida</span>
            <i *ngIf="sortColumn === 'horaSalida'" class="fas" 
              [ngClass]="{'fa-sort-up': sortDirection === 'asc', 'fa-sort-down': sortDirection === 'desc'}"></i>
          </div>
        </th>
        <th class="sortable" (click)="onSort('estado')">
          <div class="column-header">
            <i class="fas fa-info-circle"></i>
            <span>Estado</span>
            <i *ngIf="sortColumn === 'estado'" class="fas" 
              [ngClass]="{'fa-sort-up': sortDirection === 'asc', 'fa-sort-down': sortDirection === 'desc'}"></i>
          </div>
        </th>
        <th class="sortable" (click)="onSort('fecha')">
          <div class="column-header">
            <i class="fas fa-calendar-alt"></i>
            <span>Fecha</span>
            <i *ngIf="sortColumn === 'fecha'" class="fas" 
              [ngClass]="{'fa-sort-up': sortDirection === 'asc', 'fa-sort-down': sortDirection === 'desc'}"></i>
          </div>
        </th>
        <th>
          <div class="column-header">
            <i class="fas fa-cog"></i>
            <span>Acciones</span>
          </div>
        </th>
      </tr>
    </thead>
    <tbody>
      <tr *ngFor="let a of dataSource" [ngClass]="{'highlight-row': a.estado === 'TARDANZA'}">
        <td><div class="cell-content">{{ a.codigo }}</div></td>
        <td><div class="cell-content">{{ a.dni }}</div></td>
        <td><div class="cell-content">{{ a.nombre }}</div></td>
        <td><div class="cell-content">{{ a.apellido }}</div></td>
        <td><div class="cell-content">{{ a.nivel }}</div></td>
        <td><div class="cell-content">{{ a.grado }}</div></td>
        <td><div class="cell-content">{{ a.seccion }}</div></td>
        <td><div class="cell-content">{{ a.turno }}</div></td>
        <td><div class="cell-content">{{ a.horaLlegada }}</div></td>
        <td>
          <div class="cell-content">
            <span *ngIf="a.horaSalida">{{ a.horaSalida }}</span>
            <button *ngIf="!a.horaSalida" class="btn-registrar" (click)="onMarkExit(a)">
              Registrar
            </button>
          </div>
        </td>
        <td>
          <app-estado-badge [estado]="a.estado"></app-estado-badge>
        </td>
        <td><div class="cell-content">{{ formatDate(a.fecha) }}</div></td>
        <td class="acciones-cell">
          <div class="dropdown">
            <button class="btn-accion">
              <i class="fas fa-ellipsis-v"></i>
            </button>
            <div class="dropdown-menu">
              <a class="dropdown-item" (click)="onMarkAttendance(a, 'PUNTUAL')">
                <i class="fas fa-check-circle text-success"></i>
                <span>Marcar Puntual</span>
              </a>
              <a class="dropdown-item" (click)="onMarkAttendance(a, 'TARDANZA')">
                <i class="fas fa-clock text-warning"></i>
                <span>Marcar Tardanza</span>
              </a>
              <a class="dropdown-item" (click)="onMarkAttendance(a, 'AUSENTE')">
                <i class="fas fa-times-circle text-danger"></i>
                <span>Marcar Ausente</span>
              </a>
              <a class="dropdown-item" (click)="onMarkExit(a)" *ngIf="!a.horaSalida">
                <i class="fas fa-sign-out-alt text-primary"></i>
                <span>Registrar Salida</span>
              </a>
              <div class="dropdown-divider"></div>
              <a class="dropdown-item" (click)="onAddObservation(a)">
                <i class="fas fa-sticky-note"></i>
                <span>Agregar observación</span>
              </a>
            </div>
          </div>
        </td>
      </tr>
      
      <!-- Empty state -->
      <tr *ngIf="dataSource.length === 0">
        <td colspan="13" class="empty-state">
          <div class="empty-state-content">
            <i class="fas fa-search-minus empty-icon"></i>
            <p class="empty-title">No se encontraron resultados</p>
            <p class="empty-subtitle">Intente con otros criterios de búsqueda o modifique los filtros</p>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>